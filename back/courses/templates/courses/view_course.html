{% load static %}
<!--Markdownify-->
{% load markdownify %}
<!--Header-->
{% if course.acronym %}{% include "header.html" with title=course.acronym|add:"-"|add:course.name %}{% else %}{% include "header.html" with title=course.name %}{% endif %}

<!--Body-->
<body>
    <!--Feedback Button-->
    {% include "feedback.html" %}

    <!--Sidenav-->
    {% include "sidenav.html" with active_link="courses" %}

    <!--Content-->
    <div class="content">

        <!--Main Content-->
        <div class="content-main">

            <!--Course Box-->
            <div class="course-box">

                <!--Row-->
                <div class="row">

                    <div class="course-title">
                        <div>
                            {{course.name}} - ({{course.acronym}})
                            <a href="{% url 'courses:courses_index' %}" style="margin-left: auto;"><button class="button green-button">Retour à l'index</button></a>
                        </div>
                        <h5 class="text-bold mt-1">{{course.teacher}} - {{course.department}}</h5>
                    </div>
                    {%if course.new_courses.all%}
                        <h5 class="text-bold mt-2">Ce cours n'existe plus, voici une liste de cours ayant vocation à le remplacer :</h5>
                        {%for new_course in course.new_courses.all%}
                            <a href={% url 'courses:course_detail' course_id=new_course.id %}> {{new_course.name}} - ({{new_course.acronym}})</a>
                        {%endfor%}
                    {%endif%}

                </div><!--End of Row-->

                <div class="row">
                    <!--Column-->
                    <div class="col-lg-7">
                        {%if course.groups.all|length_is:1%}
                            <h5 class="text-bold mt-2"> Ce cours n'a qu'un seul groupe</h5>
                            {%for group in course.groups.all%}
                                {%if group in student.course.all%}
                                    <a href={%url 'courses:join_group' group_id=group.id action="Leave_course"%}>
                                        <button class="button red-button"> Quitter </button>
                                    </a>
                                {%else%}
                                    <a href={%url 'courses:join_group' group_id=group.id action="Join_course"%}>
                                        <button class="button blue-button"> Rejoindre </button>
                                    </a>
                                {%endif%}
                            {%endfor%}
                        {%elif course.groups.all%}
                            <h5 class="text-bold mt-2"> Groupes : </h5>
                            {%for group in course.groups.all%}
                                {%if group.number is not None%}
                                    <div class="col-lg-12">
                                        Groupe {{group.number}} : {{group.teacher}}
                                        {%if group in student.course.all%}
                                            <a href={%url 'courses:join_group' group_id=group.id action="Leave_group"%}>
                                                <button class="button red-button"> Quitter </button>
                                            </a>
                                        {%else%}
                                            <a href={%url 'courses:join_group' group_id=group.id action="Join_group"%}>
                                                <button class="button blue-button"> Rejoindre </button>
                                            </a>
                                        {%endif%}
                                    </div>
                                {%endif%}
                            {%endfor%}
                        {%endif%}
                    </div>
                </div><!--End of Column-->

            </div><!--End of Row-->

        </div><!--End of Main Content-->

    </div><!--End of Content-->

</body><!--End of Body-->

</html><!--End of Document-->
